<Page
    x:Class="eComBox.Views.SettingsPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:helper="using:eComBox.Helpers"
    xmlns:toolkit="using:CommunityToolkit.WinUI.Controls"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:xaml="using:Windows.UI.Xaml"
    xmlns:winui="using:Microsoft.UI.Xaml.Controls"
    xmlns:ui="using:CommunityToolkit.WinUI"
    xmlns:win="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    mc:Ignorable="d"
    winui:BackdropMaterial.ApplyToRootOrPageBackground="True">
    <Page.Resources>
        <ResourceDictionary>
            <Style x:Key="SettingsContentScrollViewStyle" TargetType="ScrollViewer">
                <Setter Property="HorizontalAlignment" Value="Stretch"/>
                <Setter Property="VerticalAlignment" Value="Stretch"/>
                <Setter Property="HorizontalScrollBarVisibility" Value="Disabled"/>
                <Setter Property="HorizontalScrollMode" Value="Disabled"/>
                <Setter Property="IsHorizontalRailEnabled" Value="False"/>
                <Setter Property="IsVerticalRailEnabled" Value="True"/>
                <Setter Property="VerticalScrollBarVisibility" Value="Auto"/>
                <Setter Property="VerticalScrollMode" Value="Auto"/>
                <Setter Property="ZoomMode" Value="Disabled"/>
            </Style>

            <Style x:Key="SettingsRichTextBlockStyle" TargetType="RichTextBlock">
                <Setter Property="HorizontalAlignment" Value="Left"/>
                <Setter Property="TextWrapping" Value="Wrap"/>
            </Style>

            <!-- Override default hyperlink button background color -->
            <StaticResource x:Key="HyperlinkButtonBackgroundPointerOver" ResourceKey="SubtleFillColorTransparentBrush"/>
            <StaticResource x:Key="HyperlinkButtonBackgroundPressed" ResourceKey="SubtleFillColorTransparentBrush"/>

            <x:Double x:Key="SettingsCardSpacing">4</x:Double>
            <helper:EnumToBooleanConverter x:Key="EnumToBooleanConverter" EnumType="ElementTheme" />

            <!--  Style (inc. the correct spacing) of a section header  -->
            <Style x:Key="SettingsSectionHeaderTextBlockStyle"
        BasedOn="{StaticResource BodyTextBlockStyle}"
        TargetType="TextBlock">
                <Style.Setters>
                    <Setter Property="Margin" Value="1,30,0,6" />
                </Style.Setters>
            </Style>
        </ResourceDictionary>
    </Page.Resources>
    <ScrollViewer>
        <Grid Margin="24,10,24,16">
            <StackPanel
                x:Name="ContentArea"
                MaxWidth="1000"
                HorizontalAlignment="Stretch"
                Spacing="{StaticResource SettingsCardSpacing}">
                <win:StackPanel.ChildrenTransitions>
                    <win:TransitionCollection>
                        <win:EntranceThemeTransition FromVerticalOffset="50" />
                        <win:RepositionThemeTransition IsStaggeringEnabled="False" />
                    </win:TransitionCollection>
                </win:StackPanel.ChildrenTransitions>

                <TextBlock x:Uid="Settings_Personalization" Style="{StaticResource SettingsSectionHeaderTextBlockStyle}" />
                <toolkit:SettingsExpander x:Uid="ThemeSelection" Margin="{StaticResource XSmallTopMargin}" x:Name="AppThemeExpander"
                                          Description="选择要显示的应用程序主题"
                                          Header="应用程序主题">
                    <toolkit:SettingsExpander.HeaderIcon>
                        <FontIcon Glyph="&#xE790;" />
                    </toolkit:SettingsExpander.HeaderIcon>
                    <toolkit:SettingsExpander.Items>
                        <toolkit:SettingsCard ContentAlignment="Left">
                            <winui:RadioButtons Margin="0,-8,0,0">
                                <RadioButton
                                    x:Uid="Settings_Theme_Light"
                                    Tag="Light"
                                    GroupName="AppTheme"
                                    IsChecked="{x:Bind ElementTheme, Converter={StaticResource EnumToBooleanConverter}, ConverterParameter=Light, Mode=OneWay}"
                                    Checked="ThemeChanged_CheckedAsync">
                                    <RadioButton.CommandParameter>
                                        <xaml:ElementTheme>Light</xaml:ElementTheme>
                                    </RadioButton.CommandParameter>
                                </RadioButton>
                                <RadioButton
                                    x:Uid="Settings_Theme_Dark"
                                    Tag="Dark"
                                    GroupName="AppTheme"
                                    IsChecked="{x:Bind ElementTheme, Converter={StaticResource EnumToBooleanConverter}, ConverterParameter=Dark, Mode=OneWay}"
                                    Checked="ThemeChanged_CheckedAsync">
                                    <RadioButton.CommandParameter>
                                        <xaml:ElementTheme>Dark</xaml:ElementTheme>
                                    </RadioButton.CommandParameter>
                                </RadioButton>
                                <RadioButton
                                    GroupName="AppTheme"
                                    Tag="Default"
                                    x:Uid="Settings_Theme_Default"
                                    IsChecked="{x:Bind ElementTheme, Converter={StaticResource EnumToBooleanConverter}, ConverterParameter=Default, Mode=OneWay}"
                                    Checked="ThemeChanged_CheckedAsync">
                                    <RadioButton.CommandParameter>
                                        <xaml:ElementTheme>Default</xaml:ElementTheme>
                                    </RadioButton.CommandParameter>
                                </RadioButton>
                            </winui:RadioButtons>
                        </toolkit:SettingsCard>
                    </toolkit:SettingsExpander.Items>
                </toolkit:SettingsExpander>
                <toolkit:SettingsCard Margin="{StaticResource XSmallTopMargin}" x:Uid="LanguageExpander" x:Name="LanguageExpander">
                    <toolkit:SettingsCard.HeaderIcon>
                        <FontIcon Glyph="&#xE775;" />
                    </toolkit:SettingsCard.HeaderIcon>
                    <ComboBox x:Name="LanguageComboBox" SelectionChanged="LanguageComboBox_SelectionChanged">
                        <ComboBoxItem Content="中文简体" Tag="zh-Hans-CN" />
                        <ComboBoxItem Content="English(US)" Tag="en-US" />
                    </ComboBox>
                </toolkit:SettingsCard>
                <TextBlock x:Uid="Settings_Advanced" Style="{StaticResource SettingsSectionHeaderTextBlockStyle}" />
                <toolkit:SettingsExpander x:Uid="Settings_TranslatorTool" Margin="{StaticResource XSmallTopMargin}">
                    <HyperlinkButton x:Uid="Settings_AzureTranslator" NavigateUri="https://azure.microsoft.com/zh-cn/products/ai-services/ai-translator/" Margin="{StaticResource XSmallTopMargin}" />
                    <toolkit:SettingsExpander.HeaderIcon>
                        <FontIcon Glyph="&#xF2B7;" />
                    </toolkit:SettingsExpander.HeaderIcon>
                    <toolkit:SettingsExpander.Items>
                        <toolkit:SettingsCard x:Uid="Settings_Endpoint">
                            <TextBox x:Name="EndpointTextBox"
                     Margin="{StaticResource XSmallTopMargin}"
                     Width="400"
                     Grid.Row="2"
                     FontSize="18"
                     TextChanged="EndpointTextBox_TextChanged" />
                        </toolkit:SettingsCard>
                        <toolkit:SettingsCard x:Uid="Settings_ApiKey">
                            <PasswordBox x:Name="ApiTextBox"
                         Margin="{StaticResource XSmallTopMargin}"
                         Width="400"
                         Grid.Row="2"
                         FontSize="18"
                         PasswordChanged="ApiTextBox_PasswordChanged" />
                        </toolkit:SettingsCard>
                        <toolkit:SettingsCard x:Uid="Settings_Region">
                            <TextBox x:Name="RegionTextBox"
                     Margin="{StaticResource XSmallTopMargin}"
                     Width="400"
                     Grid.Row="2"
                     FontSize="18"
                     TextChanged="RegionTextBox_TextChanged" />
                        </toolkit:SettingsCard>
                    </toolkit:SettingsExpander.Items>
                </toolkit:SettingsExpander>
                <toolkit:SettingsCard x:Uid="Settings_ai" Margin="{StaticResource XSmallTopMargin}">
                    <ToggleSwitch x:Name="AIToggleSwitch"
    Margin="{StaticResource XSmallTopMargin}"
    Toggled="AIToggleSwitch_Toggled" />
                    <toolkit:SettingsCard.HeaderIcon>
                        <FontIcon Glyph="&#xE781;" />
                    </toolkit:SettingsCard.HeaderIcon>
                </toolkit:SettingsCard>

                <toolkit:SettingsCard x:Uid="Settings_autostart" Margin="{StaticResource XSmallTopMargin}">
                    <ToggleSwitch x:Name="StartupToggle"
                                IsOn="{x:Bind IsStartupEnabled, Mode=TwoWay}"
Margin="{StaticResource XSmallTopMargin}"
Toggled="StartupToggle_Toggled" />
                    <toolkit:SettingsCard.HeaderIcon>
                        <FontIcon Glyph="&#xE7C4;" />
                    </toolkit:SettingsCard.HeaderIcon>
                </toolkit:SettingsCard>


                <toolkit:SettingsExpander x:Uid="Settings_HotList" Margin="{StaticResource XSmallTopMargin}">
                    <ToggleSwitch x:Name="HotListToggleSwitch"
                  Margin="{StaticResource XSmallTopMargin}"
                  Toggled="HotListToggleSwitch_Toggled" />
                    <toolkit:SettingsExpander.HeaderIcon>
                        <FontIcon Glyph="&#xE12A;" />
                    </toolkit:SettingsExpander.HeaderIcon>
                    <toolkit:SettingsExpander.Items>
                        <toolkit:SettingsCard x:Uid="Settings_NewsSource" IsEnabled="{x:Bind CardEnable, Mode=OneWay}">
                            <ComboBox Margin="{StaticResource XSmallTopMargin}" x:Name="UrlComboBox" SelectionChanged="UrlComboBox_SelectionChanged">
                                <ComboBoxItem x:Uid="Settings_Source_Douyin" Tag="https://doc.ecomter.site/douyin?cache=false" />
                                <ComboBoxItem x:Uid="Settings_Source_Baidu" Tag="https://doc.ecomter.site/baidu?cache=false" />
                                <ComboBoxItem x:Uid="Settings_Source_Bilibili" Tag="https://doc.ecomter.site/bilibili?cache=false" />
                                <ComboBoxItem x:Uid="Settings_Source_Weather" Tag="https://doc.ecomter.site/weatheralarm?cache=false" />
                                <ComboBoxItem x:Uid="Settings_Source_Weibo" Tag="https://doc.ecomter.site/weibo?cache=false" />
                            </ComboBox>
                        </toolkit:SettingsCard>
                    </toolkit:SettingsExpander.Items>
                </toolkit:SettingsExpander>
                <HyperlinkButton x:Uid="Settings_HotListPolicy" NavigateUri="https://ecombox.ecomter.site/docs/news_policy" Margin="{StaticResource XSmallTopMargin}" />
                <TextBlock x:Uid="Settings_About" Style="{StaticResource SettingsSectionHeaderTextBlockStyle}" />
                <toolkit:SettingsExpander x:Uid="Settings_AppInfo" HeaderIcon="{ui:BitmapIcon Source=../Assets/StoreLogo.scale-400.png}" Header="{x:Bind AppName, Mode=OneWay}" >
                    <TextBlock IsTextSelectionEnabled="True"
               Foreground="{ThemeResource TextFillColorSecondaryBrush}"
               Text="{x:Bind VersionDescription,Mode=OneWay}" />
                    <toolkit:SettingsExpander.Items>
                        <toolkit:SettingsCard HorizontalContentAlignment="Left"
                           ContentAlignment="Left">
                            <StackPanel Margin="-12,0,0,0"
                    Orientation="Vertical">
                                <TextBlock x:Uid="Settings_AboutDescription" Margin="{StaticResource XSmallTopMargin}" Style="{ThemeResource BodyTextBlockStyle}" />
                                <HyperlinkButton x:Uid="Settings_PrivacyTermsLink" Margin="{StaticResource XSmallTopMargin}" />
                                <HyperlinkButton x:Uid="Settings_githubLink" NavigateUri="https://github.com/ecomter/eComBox" Margin="{StaticResource XSmallTopMargin}" />
                                <HyperlinkButton x:Uid="Settings_PrivacyPolicy" NavigateUri="https://ecombox.ecomter.site/docs/privacy" Margin="{StaticResource XSmallTopMargin}" />
                            </StackPanel>
                        </toolkit:SettingsCard>
                    </toolkit:SettingsExpander.Items>
                </toolkit:SettingsExpander>
            </StackPanel>
            <ContentDialog
    x:Uid="Settings_TermsOfServiceDialog"
    x:Name="TermsOfServiceDialog"
    IsPrimaryButtonEnabled="False"
    PrimaryButtonClick="TermsOfServiceDialog_PrimaryButtonClick"
    SecondaryButtonClick="TermsOfServiceDialog_SecondaryButtonClick">
                <ContentDialog.Content>
                    <ScrollViewer>
                        <StackPanel Orientation="Vertical">
                            <TextBlock x:Uid="Settings_TermsDescription" TextWrapping="Wrap" />
                            <HyperlinkButton x:Uid="Settings_HotListPolicy" NavigateUri="https://ecombox.ecomter.site/docs/news_policy" Margin="{StaticResource XSmallTopMargin}" Click="TermsHyperlinkButton_Click" />
                        </StackPanel>
                    </ScrollViewer>
                </ContentDialog.Content>
            </ContentDialog>
            <ContentDialog x:Uid="errorStartDialog" x:Name="errorStartDialog">
                
            </ContentDialog>
        </Grid>
    </ScrollViewer>
</Page>
